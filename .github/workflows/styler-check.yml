name: Styler Code Formatter

on:
  push:
    paths:
      - '**.R'
  pull_request:
    paths:
      - '**.R'

jobs:
  styler:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Clona el repositorio
        uses: actions/checkout@v4

      - name: ğŸ§° Instala R
        uses: r-lib/actions/setup-r@v2

      - name: ğŸ“¦ Instala los paquetes necesarios
        run: |
          install.packages(c("styler"))

      - name: ğŸ¯ Ejecuta styler::style_dir() y verifica
        run: |
          result <- styler::style_dir(dry = TRUE)
          if (length(result) > 0) {
            stop("âŒ Hay archivos R que no cumplen con el estilo de cÃ³digo.")
          } else {
            cat("âœ… Todos los archivos R estÃ¡n bien formateados.\n")
          }
        shell: Rscript brokergeneral.R
