name: Styler Code Formatter

on:
  push:
    paths:
      - '**.R'
  pull_request:
    paths:
      - '**.R'

jobs:
  styler:
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Clona el repositorio
        uses: actions/checkout@v4

      - name: 🧰 Instala R
        uses: r-lib/actions/setup-r@v2

      - name: 📦 Instala los paquetes necesarios
        run: |
          install.packages(c("styler"))

      - name: 🎯 Ejecuta styler::style_dir() y verifica
        run: |
          result <- styler::style_dir(dry = TRUE)
          if (length(result) > 0) {
            stop("❌ Hay archivos R que no cumplen con el estilo de código.")
          } else {
            cat("✅ Todos los archivos R están bien formateados.\n")
          }
        shell: Rscript brokergeneral.R
